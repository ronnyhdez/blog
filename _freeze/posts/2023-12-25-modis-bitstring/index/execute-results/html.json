{
  "hash": "cb80c97f69372dff1e95bb638ef3e019",
  "result": {
    "markdown": "---\ntitle: \"MODIS pixel bit strings conversion with R\"\ndescription: |\n   MODIS satellite images come with bit information regarding the quality of\n   pixels. In this post, I'll explore how to interpret these bits and categorize\n   them for quality filtering using R.\ndate: 2024-05-01\ncategories: [MODIS, R, bits]\nlicence: \"CC BY-NC\"\nimage: images/nicoya.png\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n\n# What are we going to do?\n\nSo, I was working with some [MODIS Surfance Reflectance product images](https://lpdaac.usgs.gov/products/mod09gav061/) \nfrom which I needed to calculate 4 vegetation indices to estimate Gross Primary\nProduction. Apart from being careful with selecting images without snow or \nclouds I knew that every pixel comes with QA information useful to decide if\nincluding or not some of the pixels. Nonetheless, I was confused on how to \nperform such task on the many pixels that I had, and furthermore how to deal \nwith the bits transformation into categories that I could understand and then\nfilter in R according to their quality. \n\nLuckily there are sources of documentation that I could go through to understand\nand get to work in my project. There was one [blog post by Steve Mosher](https://stevemosher.wordpress.com/2012/12/05/modis-qc-bits/)\nfrom where I understood better what needed to be done. So I wrote down \neverything it worked for me and finally put it here. \n\n# MODIS and the bit strings\n\n <!-- - Explain that each pixel will come with data about quality -->\n <!-- - Make reference to documentation -->\n <!-- - Explain QA in images -->\n<!--  Intro about what is MODIS, where to find the data, bands, metadata and the -->\n<!-- variables with the bits. -->\n \nThe [MODIS reference manual](https://lpdaac.usgs.gov/documents/306/MOD09_User_Guide_V6.pdf) ...\n\n## Variables with bit strings\n\n <!-- - Mention variables with bitstrings -->\n <!-- - Explain what is the meaning of each of the variables -->\n <!-- - Explore (check unique values) the variables -->\n\nThere are 4 variables in the dataset with a bitmask that needs to be converted:\n\n-   `state_1km`\n-   `gflags`\n-   `qc_500m`\n-   `q_scan`\n\nAccording to the technical documentation, this variables contain information\nabout ....\n\n\nLet's read the dataset to explore what do we have originally in here\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Data\nreflectance_500 <- \n  readRDS(here(\"posts/2023-12-25-modis-bitstring/data/borden_modis_reflectance_500_clean.rds\"))\n```\n:::\n\n\n#### How many unique values do I have per each of the quality variables?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreflectance_500 |>\n  select(state_1km, gflags, qc_500m, q_scan) |> \n  purrr::map(~unique(.))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$state_1km\n [1]  1033 40969  8392  1034 40970  5384  1289  1801 45068  1545  8397  8398\n[13]  1032  8396  8393  5128 40973 40974 45064  8394 32781   206 36872 32778\n[25] 32777  5640 36876 32776 45066  8334   200   138   136     8    72  8264\n[37]  1544  8332  1802  1288  8328  1546  8268  8330  8205    76   204   141\n[49]   140  8204 40972  8266   137  1290    74  1800 32780  5896 40968   205\n[61]   202   201  8329  8270  5385  5898  5642\n\n$gflags\n[1] 0\n\n$qc_500m\n [1] 1073741824 1073968181 1073954817 1075838976 1073968129 1073755137\n [7] 1073755189 1075852341 1076065281 1946383413 1073969013 1073954869\n[13] 1075852289 1076065333 1076051969 1075576832 1075590145 1075803189\n\n$q_scan\n [1] 14  8  9  2  0  6 15  3 13 11 12  1  7 10  5  4\n```\n:::\n:::\n\n\nSo, in our dataset, `state_1km` has 67\ndistinct values, `gflags` variable has 1 so\nwe are not going to use this one, `qc_500m` has \n18 distinct values, and `q_scan` variable\nhas 16 unique values. We need to convert\nthis integers into bits and then, make sense of those bits. This is going to\nbe our first part of the exploration.\n\n# Using bits in R\n\n <!-- - Explanation to understand how to perform the bit conversion in R -->\n\nSo, how do we accomplish this in R? Fortunately, we have some functions in base\nR specifically designed to handle this type of information. In our case, the\nfunction `intToBits()` will be particularly helpful. For instance, let's \nconsider one of the values from the `q_scan` variable: the integer `14`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nintToBits(14)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] 00 01 01 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n[26] 00 00 00 00 00 00 00\n```\n:::\n:::\n\n\nThat's quite a lengthy bit string! It contains more information than necessary.\nTherefore, we need to shorten this bit string and convert it into an integer. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nas.integer(intToBits(14)[1:8])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0 1 1 1 0 0 0 0\n```\n:::\n:::\n\n\n - Remember that this has to be read from left to right. So the first bit is 0.\n - The 8 bits are numbered from 0 to 7 (as opposed to the R default).\n - Each bit represents a power of 2.\n - We need to reverse this bit string\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbit_string <- as.integer(intToBits(14)[1:8])\nbit_string[8:1]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0 0 0 0 1 1 1 0\n```\n:::\n:::\n\n\n# Binary conversion\n\nEvery pixel in the satellite images contains an integer value that must be \nconverted to a bit binary value for interpretation. At first, it seems \ncomplicated but the documentation will help us here. For any sensor, we would\nneed to check the documentation in order to perform any binary conversion and\ninterpretation.\n\nThere is also a good video from the United States Geological Survey (USGS) that\nexplains the process for the interpretation of the binary conversion with\nthe documentation. From minute 2:34 of this [USGS video](https://www.usgs.gov/media/videos/getting-started-modis-v6-surface-reflectance-data-part-3) it shows the process of the binary conversion.\n\n## How can I apply the idea to our MODIS data?\n\nWe've covered the basics of understanding bits, binary conversion, and\ninterpretation. But how do we put this knowledge to use with our dataset? This \nis where [Steve Mosher's blog post](https://stevemosher.wordpress.com/2012/12/05/modis-qc-bits/)\ncomes in handy.\n\nLet's start by taking a single value from the `qc_500m` variable in our \ndataset: `1075803189`. Here are the steps we'll follow:\n\n - Utilize the `intToBits()` function to obtain the binary representation.\n - Shorten the lengthy bit string to only include the necessary bits.\n - Reverse the order of the bits.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Using one bitmask value from the dataset\nbits <- as.integer(intToBits(1075803189)[1:32])\nbits\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] 1 0 1 0 1 1 0 0 0 0 1 0 1 1 1 0 1 1 1 1 1 0 0 0 0 0 0 0 0 0 1 0\n```\n:::\n\n```{.r .cell-code}\n# Reverse\nbits[32:1]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] 0 1 0 0 0 0 0 0 0 0 0 1 1 1 1 1 0 1 1 1 0 1 0 0 0 0 1 1 0 1 0 1\n```\n:::\n:::\n\n\nOk! It looks like it works. But I'm not sure, so let's do the same process but\nusing the example from the USGS video.\n\n## Process validation \n\nIn the USGS video explanation, they show the binary conversion process with\nan example. I'm going to use the same integer value `1131675649` to validate\nif our code steps work as expected.\n\n![USGS video integer example](images/usgs_example_int.png)\n\nThe bit string obtained from the binary conversion should be:\n\n![USGS bit string example](images/usgs_example_binary.png)\n\nThat bit string should be matched with the categories assigned and described in\nthe documentation:\n\n![USGS bit string quality categories](images/usgs_bit_conversion_video.png)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#  Using the example value from video\nbinary_conversion <- as.integer(intToBits(1131675649)[1:32])\nbit_string <- binary_conversion[32:1]\n\n# This one is the result of the binary transformation from the video\nvalidation <- c(0,1,0,0,0,0,1,1,0,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1)\n\n# Check if object is the same as the one written by hand\nstopifnot(bit_string == validation)\n```\n:::\n\n\nThe steps does match the final result. Next, I need to apply the same logical\nconditions to my data.\n\n## Code to apply the bit string conversion to the variables\n\nNow that I know which steps are needed to do the conversion, I need to develop \nthe code further to apply it to each of the variables with a bit mask. On this\nfirst try, I will do it with the variable `qc_500m`.\n\nFor this variable, I'm going to create a dataset with the variable\n`qc_ints` that contains the 18 unique integer values from the `qc_500m`\nvariable plus one more observation from USGS video example to use it as a test\nvalidation. Then I'm going to add 32 more variables for each of the bits that\nwe will obtain from the binary conversion process.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Create column with unique values and add one validation (from the video)\nqc_data <- data.frame(qc_ints = c(unique(reflectance_500$qc_500m), 1131675649))\n\n## Create empty data frame. This case is 32 given that the variable\n## `qc_500m` have 32 bits\nfor (i in c(31:0)) {\n  qc_data[, paste0(\"bit_\", i)] <- NA\n}\n```\n:::\n\n\nHere is how the data frame looks like:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npaged_table(qc_data)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"qc_ints\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"bit_31\"],\"name\":[2],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_30\"],\"name\":[3],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_29\"],\"name\":[4],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_28\"],\"name\":[5],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_27\"],\"name\":[6],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_26\"],\"name\":[7],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_25\"],\"name\":[8],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_24\"],\"name\":[9],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_23\"],\"name\":[10],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_22\"],\"name\":[11],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_21\"],\"name\":[12],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_20\"],\"name\":[13],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_19\"],\"name\":[14],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_18\"],\"name\":[15],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_17\"],\"name\":[16],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_16\"],\"name\":[17],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_15\"],\"name\":[18],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_14\"],\"name\":[19],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_13\"],\"name\":[20],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_12\"],\"name\":[21],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_11\"],\"name\":[22],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_10\"],\"name\":[23],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_9\"],\"name\":[24],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_8\"],\"name\":[25],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_7\"],\"name\":[26],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_6\"],\"name\":[27],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_5\"],\"name\":[28],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_4\"],\"name\":[29],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_3\"],\"name\":[30],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_2\"],\"name\":[31],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_1\"],\"name\":[32],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"bit_0\"],\"name\":[33],\"type\":[\"lgl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1073741824\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\"},{\"1\":\"1073968181\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\"},{\"1\":\"1073954817\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\"},{\"1\":\"1075838976\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\"},{\"1\":\"1073968129\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\"},{\"1\":\"1073755137\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\"},{\"1\":\"1073755189\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\"},{\"1\":\"1075852341\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\"},{\"1\":\"1076065281\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\"},{\"1\":\"1946383413\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\"},{\"1\":\"1073969013\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\"},{\"1\":\"1073954869\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\"},{\"1\":\"1075852289\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\"},{\"1\":\"1076065333\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\"},{\"1\":\"1076051969\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\"},{\"1\":\"1075576832\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\"},{\"1\":\"1075590145\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\"},{\"1\":\"1075803189\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\"},{\"1\":\"1131675649\",\"2\":\"NA\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\",\"27\":\"NA\",\"28\":\"NA\",\"29\":\"NA\",\"30\":\"NA\",\"31\":\"NA\",\"32\":\"NA\",\"33\":\"NA\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nSo far, we have a dataframe with 33 variables (one with the original integers\nvalues and 32 more to fill with the bit strings) and 19 observations. Now I can\nloop through each of the bits variables filling them with the values from the\nbinary conversion result from the original integers\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Loop for obtaining bit string from unique values in the variable\nz <- 1\nfor (i in qc_data$qc_ints) {\n  # print(i)\n  transformed <- as.integer(intToBits(i)[1:32])\n  qc_data[z, 2:33] <- transformed[32:1]\n  z <- z + 1\n}\n\n# Check the data frame\npaged_table(qc_data)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"qc_ints\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"bit_31\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_30\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_29\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_28\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_27\"],\"name\":[6],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_26\"],\"name\":[7],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_25\"],\"name\":[8],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_24\"],\"name\":[9],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_23\"],\"name\":[10],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_22\"],\"name\":[11],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_21\"],\"name\":[12],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_20\"],\"name\":[13],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_19\"],\"name\":[14],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_18\"],\"name\":[15],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_17\"],\"name\":[16],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_16\"],\"name\":[17],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_15\"],\"name\":[18],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_14\"],\"name\":[19],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_13\"],\"name\":[20],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_12\"],\"name\":[21],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_11\"],\"name\":[22],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_10\"],\"name\":[23],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_9\"],\"name\":[24],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_8\"],\"name\":[25],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_7\"],\"name\":[26],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_6\"],\"name\":[27],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_5\"],\"name\":[28],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_4\"],\"name\":[29],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_3\"],\"name\":[30],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_2\"],\"name\":[31],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_1\"],\"name\":[32],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_0\"],\"name\":[33],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1073741824\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"0\",\"33\":\"0\"},{\"1\":\"1073968181\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"1\",\"17\":\"1\",\"18\":\"0\",\"19\":\"1\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"1\",\"29\":\"1\",\"30\":\"0\",\"31\":\"1\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1073954817\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"1\",\"17\":\"1\",\"18\":\"0\",\"19\":\"1\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1075838976\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"1\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"0\",\"33\":\"0\"},{\"1\":\"1073968129\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"1\",\"17\":\"1\",\"18\":\"0\",\"19\":\"1\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1073755137\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1073755189\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"1\",\"29\":\"1\",\"30\":\"0\",\"31\":\"1\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1075852341\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"1\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"1\",\"29\":\"1\",\"30\":\"0\",\"31\":\"1\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1076065281\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"1\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"1\",\"17\":\"1\",\"18\":\"0\",\"19\":\"1\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1946383413\",\"2\":\"0\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"0\",\"7\":\"1\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"1\",\"17\":\"1\",\"18\":\"0\",\"19\":\"1\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"1\",\"29\":\"1\",\"30\":\"0\",\"31\":\"1\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1073969013\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"1\",\"17\":\"1\",\"18\":\"0\",\"19\":\"1\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"1\",\"25\":\"1\",\"26\":\"0\",\"27\":\"1\",\"28\":\"1\",\"29\":\"1\",\"30\":\"0\",\"31\":\"1\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1073954869\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"1\",\"17\":\"1\",\"18\":\"0\",\"19\":\"1\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"1\",\"29\":\"1\",\"30\":\"0\",\"31\":\"1\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1075852289\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"1\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1076065333\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"1\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"1\",\"17\":\"1\",\"18\":\"0\",\"19\":\"1\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"1\",\"29\":\"1\",\"30\":\"0\",\"31\":\"1\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1076051969\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"1\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"1\",\"17\":\"1\",\"18\":\"0\",\"19\":\"1\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1075576832\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"1\",\"14\":\"1\",\"15\":\"1\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"0\",\"33\":\"0\"},{\"1\":\"1075590145\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"1\",\"14\":\"1\",\"15\":\"1\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1075803189\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"1\",\"14\":\"1\",\"15\":\"1\",\"16\":\"1\",\"17\":\"1\",\"18\":\"0\",\"19\":\"1\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"1\",\"29\":\"1\",\"30\":\"0\",\"31\":\"1\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1131675649\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"1\",\"9\":\"1\",\"10\":\"0\",\"11\":\"1\",\"12\":\"1\",\"13\":\"1\",\"14\":\"0\",\"15\":\"1\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"0\",\"33\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nEvery bit variable is filled with `0's` or `1's`. Looks good, but I want to \nvalidate with the USGS example observation we added at the beginning if I'm\nobtaining the correct bit strings:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Create test according to value in video\nprocess_test <- qc_data |> \n  filter(qc_ints == 1131675649) |>\n  select(-qc_ints) |>\n  unite(col = \"new\", bit_31:bit_0, sep = \"\") |> \n  pull() \n\nstopifnot(process_test == \"01000011011101000000000000000001\")\n```\n:::\n\n\nNow we know that the code is working and we can perform the binary conversion\nsuccessfully, we can continue with the matching of categorization of the quality\naccording to the documentation.\n\n# Categories for each of the bit strings\n\nContinuing with the variable `qc_500m` from which I have already the bit \nstrings, I can follow the [MODIS documentation](https://lpdaac.usgs.gov/documents/306/MOD09_User_Guide_V6.pdf) \nto add the categories for each combination of bits.\n\nThis steps can be done in **two** different (but similar) ways: using\nconditionals for each of the bits, or joining the variables with the specific \nbits. \n\n\n::: {.cell}\n\n```{.r .cell-code}\npaged_table(qc_data)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"qc_ints\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"bit_31\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_30\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_29\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_28\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_27\"],\"name\":[6],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_26\"],\"name\":[7],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_25\"],\"name\":[8],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_24\"],\"name\":[9],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_23\"],\"name\":[10],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_22\"],\"name\":[11],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_21\"],\"name\":[12],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_20\"],\"name\":[13],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_19\"],\"name\":[14],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_18\"],\"name\":[15],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_17\"],\"name\":[16],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_16\"],\"name\":[17],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_15\"],\"name\":[18],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_14\"],\"name\":[19],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_13\"],\"name\":[20],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_12\"],\"name\":[21],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_11\"],\"name\":[22],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_10\"],\"name\":[23],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_9\"],\"name\":[24],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_8\"],\"name\":[25],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_7\"],\"name\":[26],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_6\"],\"name\":[27],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_5\"],\"name\":[28],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_4\"],\"name\":[29],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_3\"],\"name\":[30],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_2\"],\"name\":[31],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_1\"],\"name\":[32],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_0\"],\"name\":[33],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1073741824\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"0\",\"33\":\"0\"},{\"1\":\"1073968181\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"1\",\"17\":\"1\",\"18\":\"0\",\"19\":\"1\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"1\",\"29\":\"1\",\"30\":\"0\",\"31\":\"1\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1073954817\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"1\",\"17\":\"1\",\"18\":\"0\",\"19\":\"1\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1075838976\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"1\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"0\",\"33\":\"0\"},{\"1\":\"1073968129\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"1\",\"17\":\"1\",\"18\":\"0\",\"19\":\"1\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1073755137\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1073755189\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"1\",\"29\":\"1\",\"30\":\"0\",\"31\":\"1\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1075852341\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"1\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"1\",\"29\":\"1\",\"30\":\"0\",\"31\":\"1\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1076065281\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"1\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"1\",\"17\":\"1\",\"18\":\"0\",\"19\":\"1\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1946383413\",\"2\":\"0\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"0\",\"7\":\"1\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"1\",\"17\":\"1\",\"18\":\"0\",\"19\":\"1\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"1\",\"29\":\"1\",\"30\":\"0\",\"31\":\"1\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1073969013\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"1\",\"17\":\"1\",\"18\":\"0\",\"19\":\"1\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"1\",\"25\":\"1\",\"26\":\"0\",\"27\":\"1\",\"28\":\"1\",\"29\":\"1\",\"30\":\"0\",\"31\":\"1\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1073954869\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"1\",\"17\":\"1\",\"18\":\"0\",\"19\":\"1\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"1\",\"29\":\"1\",\"30\":\"0\",\"31\":\"1\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1075852289\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"1\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1076065333\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"1\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"1\",\"17\":\"1\",\"18\":\"0\",\"19\":\"1\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"1\",\"29\":\"1\",\"30\":\"0\",\"31\":\"1\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1076051969\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"1\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"1\",\"17\":\"1\",\"18\":\"0\",\"19\":\"1\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1075576832\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"1\",\"14\":\"1\",\"15\":\"1\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"0\",\"33\":\"0\"},{\"1\":\"1075590145\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"1\",\"14\":\"1\",\"15\":\"1\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1075803189\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"1\",\"14\":\"1\",\"15\":\"1\",\"16\":\"1\",\"17\":\"1\",\"18\":\"0\",\"19\":\"1\",\"20\":\"1\",\"21\":\"1\",\"22\":\"0\",\"23\":\"1\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"1\",\"29\":\"1\",\"30\":\"0\",\"31\":\"1\",\"32\":\"0\",\"33\":\"1\"},{\"1\":\"1131675649\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"1\",\"9\":\"1\",\"10\":\"0\",\"11\":\"1\",\"12\":\"1\",\"13\":\"1\",\"14\":\"0\",\"15\":\"1\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"0\",\"33\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n**First possible solution**\n\nThis one will take the bits separately and use the boolean `&` to categorize\nthe information contained in the bit string:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqc_data |> \n  mutate(modland_qa = case_when(\n    bit_1 == 0 & bit_0 == 0 ~ \"ideal quality - all bands\",\n    bit_1 == 0 & bit_0 == 1 ~ \"less than ideal quality - some or all bands\",\n    bit_1 == 1 & bit_0 == 0 ~ \"product not produced due to cloud effects\",\n    bit_1 == 1 & bit_0 == 1 ~ \"product not produced for other reasons\",\n    TRUE ~ \"No info, please validate bit conversion\"\n  )) |> \n  select(qc_ints, bit_1, bit_0, modland_qa) |> \n  paged_table()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"qc_ints\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"bit_1\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_0\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"modland_qa\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"1073741824\",\"2\":\"0\",\"3\":\"0\",\"4\":\"ideal quality - all bands\"},{\"1\":\"1073968181\",\"2\":\"0\",\"3\":\"1\",\"4\":\"less than ideal quality - some or all bands\"},{\"1\":\"1073954817\",\"2\":\"0\",\"3\":\"1\",\"4\":\"less than ideal quality - some or all bands\"},{\"1\":\"1075838976\",\"2\":\"0\",\"3\":\"0\",\"4\":\"ideal quality - all bands\"},{\"1\":\"1073968129\",\"2\":\"0\",\"3\":\"1\",\"4\":\"less than ideal quality - some or all bands\"},{\"1\":\"1073755137\",\"2\":\"0\",\"3\":\"1\",\"4\":\"less than ideal quality - some or all bands\"},{\"1\":\"1073755189\",\"2\":\"0\",\"3\":\"1\",\"4\":\"less than ideal quality - some or all bands\"},{\"1\":\"1075852341\",\"2\":\"0\",\"3\":\"1\",\"4\":\"less than ideal quality - some or all bands\"},{\"1\":\"1076065281\",\"2\":\"0\",\"3\":\"1\",\"4\":\"less than ideal quality - some or all bands\"},{\"1\":\"1946383413\",\"2\":\"0\",\"3\":\"1\",\"4\":\"less than ideal quality - some or all bands\"},{\"1\":\"1073969013\",\"2\":\"0\",\"3\":\"1\",\"4\":\"less than ideal quality - some or all bands\"},{\"1\":\"1073954869\",\"2\":\"0\",\"3\":\"1\",\"4\":\"less than ideal quality - some or all bands\"},{\"1\":\"1075852289\",\"2\":\"0\",\"3\":\"1\",\"4\":\"less than ideal quality - some or all bands\"},{\"1\":\"1076065333\",\"2\":\"0\",\"3\":\"1\",\"4\":\"less than ideal quality - some or all bands\"},{\"1\":\"1076051969\",\"2\":\"0\",\"3\":\"1\",\"4\":\"less than ideal quality - some or all bands\"},{\"1\":\"1075576832\",\"2\":\"0\",\"3\":\"0\",\"4\":\"ideal quality - all bands\"},{\"1\":\"1075590145\",\"2\":\"0\",\"3\":\"1\",\"4\":\"less than ideal quality - some or all bands\"},{\"1\":\"1075803189\",\"2\":\"0\",\"3\":\"1\",\"4\":\"less than ideal quality - some or all bands\"},{\"1\":\"1131675649\",\"2\":\"0\",\"3\":\"1\",\"4\":\"less than ideal quality - some or all bands\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n**Second possible solution**\n\nFor this one, I will join the bits and then categorize each one accordingly:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Second possible solution\nqc_data |> \n  unite(col = \"modland\", c(\"bit_1\", \"bit_0\"), sep = \"\") |> \n  mutate(modland_qa = case_when(\n    modland == \"00\" ~ \"ideal quality - all bands\",\n    modland == \"01\" ~ \"less than ideal quality - some or all bands\",\n    modland == \"10\" ~ \"product not produced due to cloud effects\",\n    modland == \"11\" ~ \"product not produced for other reasons\",\n    TRUE ~ \"No info, please validate bit conversion\"\n  )) |> \n  select(qc_ints, modland, modland_qa) |> \n  paged_table()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"qc_ints\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"modland\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"modland_qa\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"1073741824\",\"2\":\"00\",\"3\":\"ideal quality - all bands\"},{\"1\":\"1073968181\",\"2\":\"01\",\"3\":\"less than ideal quality - some or all bands\"},{\"1\":\"1073954817\",\"2\":\"01\",\"3\":\"less than ideal quality - some or all bands\"},{\"1\":\"1075838976\",\"2\":\"00\",\"3\":\"ideal quality - all bands\"},{\"1\":\"1073968129\",\"2\":\"01\",\"3\":\"less than ideal quality - some or all bands\"},{\"1\":\"1073755137\",\"2\":\"01\",\"3\":\"less than ideal quality - some or all bands\"},{\"1\":\"1073755189\",\"2\":\"01\",\"3\":\"less than ideal quality - some or all bands\"},{\"1\":\"1075852341\",\"2\":\"01\",\"3\":\"less than ideal quality - some or all bands\"},{\"1\":\"1076065281\",\"2\":\"01\",\"3\":\"less than ideal quality - some or all bands\"},{\"1\":\"1946383413\",\"2\":\"01\",\"3\":\"less than ideal quality - some or all bands\"},{\"1\":\"1073969013\",\"2\":\"01\",\"3\":\"less than ideal quality - some or all bands\"},{\"1\":\"1073954869\",\"2\":\"01\",\"3\":\"less than ideal quality - some or all bands\"},{\"1\":\"1075852289\",\"2\":\"01\",\"3\":\"less than ideal quality - some or all bands\"},{\"1\":\"1076065333\",\"2\":\"01\",\"3\":\"less than ideal quality - some or all bands\"},{\"1\":\"1076051969\",\"2\":\"01\",\"3\":\"less than ideal quality - some or all bands\"},{\"1\":\"1075576832\",\"2\":\"00\",\"3\":\"ideal quality - all bands\"},{\"1\":\"1075590145\",\"2\":\"01\",\"3\":\"less than ideal quality - some or all bands\"},{\"1\":\"1075803189\",\"2\":\"01\",\"3\":\"less than ideal quality - some or all bands\"},{\"1\":\"1131675649\",\"2\":\"01\",\"3\":\"less than ideal quality - some or all bands\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nConsidering that I'll need to write out each condition to categorize them\naccording to the documentation, I believe it would be more manageable and \nreadable to follow the second solution. For each series of bits, I'll merge them\nas a single column and categorize them.\n\n## `qc_500m` complete bit string categories\n\nThe following code chunk encompasses all the necessary steps to incorporate all\nthe categories specified in the MODIS documentation. Initially, it involves merging the required bits into columns and then generating the categorization as\ndescribed in the documentation. The outcome of this process will be a data frame\ncontaining the categories for the original integer values within our variable\n\nFrom the documentation, we have which bit strings should be considered together\nto classify the values into categories. Based on those bit positions, we are\ngoing to unite the columns to obtain the bit combination. For example, for the\n`Parameter Name` MODLAND QA bits, we have to take the bit in position 0 and the\nbit position 1, which can have 4 different combinations: `00`, `01`,\n`10`, and `11`. Each of those 4 combinations will be categorized into their \nrespective categories.\n\n![Coarse Resolution Surface Reflectance Band Quality Description](images/qc_bit_order.png)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqc_500_description <- qc_data |> \n  unite(col = \"modland\", c(\"bit_1\", \"bit_0\"), sep = \"\") |> \n  unite(col = \"band_1\", \n        c(\"bit_5\", \"bit_4\", \"bit_3\", \"bit_2\"), sep = \"\") |> \n  unite(col = \"band_2\", \n        c(\"bit_9\", \"bit_8\", \"bit_7\", \"bit_6\"), sep = \"\") |> \n  unite(col = \"band_3\", \n        c(\"bit_13\", \"bit_12\", \"bit_11\", \"bit_10\"), sep = \"\") |> \n  unite(col = \"band_4\", \n        c(\"bit_17\", \"bit_16\", \"bit_15\", \"bit_14\"), sep = \"\") |> \n  unite(col = \"band_5\", \n        c(\"bit_21\", \"bit_20\", \"bit_19\", \"bit_18\"), sep = \"\") |> \n  unite(col = \"band_6\", \n        c(\"bit_25\", \"bit_24\", \"bit_23\", \"bit_22\"), sep = \"\") |>\n  unite(col = \"band_7\", \n        c(\"bit_29\", \"bit_28\", \"bit_27\", \"bit_26\"), sep = \"\") |> \n  mutate(modland_qa = case_when(\n    modland == \"00\" ~ \"ideal quality - all bands\",\n    modland == \"01\" ~ \"less than ideal quality - some or all bands\",\n    modland == \"10\" ~ \"product not produced due to cloud effects\",\n    modland == \"11\" ~ \"product not produced for other reasons\",\n    TRUE ~ \"No info, please validate bit conversion\"\n  )) |> \n  mutate(band1_qa = case_when(\n    band_1 == \"0000\" ~ \"highest_quality\",\n    band_1 == \"0111\" ~ \"noisy detector\",\n    band_1 == \"1000\" ~ \"dead detector, data interpolated in L1B\",\n    band_1 == \"1001\" ~ \"solar zenith >= 86 degrees\",\n    band_1 == \"1010\" ~ \"solar zenith >= 85 and < 86 degrees\",\n    band_1 == \"1011\" ~ \"missing input\",\n    band_1 == \"1100\" ~ \"internal constant used\",\n    band_1 == \"1101\" ~ \"correction out of bounds\",\n    band_1 == \"1110\" ~ \"L1B data faulty\",\n    band_1 == \"1111\" ~ \"not processed due to deep ocean or clouds\",\n    TRUE ~ \"No info, please validate bit conversion\"\n  )) |> \n  mutate(band2_qa = case_when(\n    band_2 == \"0000\" ~ \"highest_quality\",\n    band_2 == \"0111\" ~ \"noisy detector\",\n    band_2 == \"1000\" ~ \"dead detector, data interpolated in L1B\",\n    band_2 == \"1001\" ~ \"solar zenith >= 86 degrees\",\n    band_2 == \"1010\" ~ \"solar zenith >= 85 and < 86 degrees\",\n    band_2 == \"1011\" ~ \"missing input\",\n    band_2 == \"1100\" ~ \"internal constant used\",\n    band_2 == \"1101\" ~ \"correction out of bounds\",\n    band_2 == \"1110\" ~ \"L1B data faulty\",\n    band_2 == \"1111\" ~ \"not processed due to deep ocean or clouds\",\n    TRUE ~ \"No info, please validate bit conversion\"\n  )) |> \n  mutate(band3_qa = case_when(\n    band_3 == \"0000\" ~ \"highest_quality\",\n    band_3 == \"0111\" ~ \"noisy detector\",\n    band_3 == \"1000\" ~ \"dead detector, data interpolated in L1B\",\n    band_3 == \"1001\" ~ \"solar zenith >= 86 degrees\",\n    band_3 == \"1010\" ~ \"solar zenith >= 85 and < 86 degrees\",\n    band_3 == \"1011\" ~ \"missing input\",\n    band_3 == \"1100\" ~ \"internal constant used\",\n    band_3 == \"1101\" ~ \"correction out of bounds\",\n    band_3 == \"1110\" ~ \"L1B data faulty\",\n    band_3 == \"1111\" ~ \"not processed due to deep ocean or clouds\",\n    TRUE ~ \"No info, please validate bit conversion\"\n  )) |> \n  mutate(band4_qa = case_when(\n    band_4 == \"0000\" ~ \"highest_quality\",\n    band_4 == \"0111\" ~ \"noisy detector\",\n    band_4 == \"1000\" ~ \"dead detector, data interpolated in L1B\",\n    band_4 == \"1001\" ~ \"solar zenith >= 86 degrees\",\n    band_4 == \"1010\" ~ \"solar zenith >= 85 and < 86 degrees\",\n    band_4 == \"1011\" ~ \"missing input\",\n    band_4 == \"1100\" ~ \"internal constant used\",\n    band_4 == \"1101\" ~ \"correction out of bounds\",\n    band_4 == \"1110\" ~ \"L1B data faulty\",\n    band_4 == \"1111\" ~ \"not processed due to deep ocean or clouds\",\n    TRUE ~ \"No info, please validate bit conversion\"\n  )) |> \n  mutate(band5_qa = case_when(\n    band_5 == \"0000\" ~ \"highest_quality\",\n    band_5 == \"0111\" ~ \"noisy detector\",\n    band_5 == \"1000\" ~ \"dead detector, data interpolated in L1B\",\n    band_5 == \"1001\" ~ \"solar zenith >= 86 degrees\",\n    band_5 == \"1010\" ~ \"solar zenith >= 85 and < 86 degrees\",\n    band_5 == \"1011\" ~ \"missing input\",\n    band_5 == \"1100\" ~ \"internal constant used\",\n    band_5 == \"1101\" ~ \"correction out of bounds\",\n    band_5 == \"1110\" ~ \"L1B data faulty\",\n    band_5 == \"1111\" ~ \"not processed due to deep ocean or clouds\",\n    TRUE ~ \"No info, please validate bit conversion\"\n  )) |> \n  mutate(band6_qa = case_when(\n    band_6 == \"0000\" ~ \"highest_quality\",\n    band_6 == \"0111\" ~ \"noisy detector\",\n    band_6 == \"1000\" ~ \"dead detector, data interpolated in L1B\",\n    band_6 == \"1001\" ~ \"solar zenith >= 86 degrees\",\n    band_6 == \"1010\" ~ \"solar zenith >= 85 and < 86 degrees\",\n    band_6 == \"1011\" ~ \"missing input\",\n    band_6 == \"1100\" ~ \"internal constant used\",\n    band_6 == \"1101\" ~ \"correction out of bounds\",\n    band_6 == \"1110\" ~ \"L1B data faulty\",\n    band_6 == \"1111\" ~ \"not processed due to deep ocean or clouds\",\n    TRUE ~ \"No info, please validate bit conversion\"\n  )) |> \n  mutate(band7_qa = case_when(\n    band_7 == \"0000\" ~ \"highest_quality\",\n    band_7 == \"0111\" ~ \"noisy detector\",\n    band_7 == \"1000\" ~ \"dead detector, data interpolated in L1B\",\n    band_7 == \"1001\" ~ \"solar zenith >= 86 degrees\",\n    band_7 == \"1010\" ~ \"solar zenith >= 85 and < 86 degrees\",\n    band_7 == \"1011\" ~ \"missing input\",\n    band_7 == \"1100\" ~ \"internal constant used\",\n    band_7 == \"1101\" ~ \"correction out of bounds\",\n    band_7 == \"1110\" ~ \"L1B data faulty\",\n    band_7 == \"1111\" ~ \"not processed due to deep ocean or clouds\",\n    TRUE ~ \"No info, please validate bit conversion\"\n  )) |> \n  mutate(atmospheric_correction = ifelse(bit_30 == 0, \"no\", \"yes\"),\n         adjacency_correction = ifelse(bit_31 == 0, \"no\", \"yes\"))\n\npaged_table(qc_500_description)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"qc_ints\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"bit_31\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_30\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"band_7\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"band_6\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"band_5\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"band_4\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"band_3\"],\"name\":[8],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"band_2\"],\"name\":[9],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"band_1\"],\"name\":[10],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"modland\"],\"name\":[11],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"modland_qa\"],\"name\":[12],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"band1_qa\"],\"name\":[13],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"band2_qa\"],\"name\":[14],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"band3_qa\"],\"name\":[15],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"band4_qa\"],\"name\":[16],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"band5_qa\"],\"name\":[17],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"band6_qa\"],\"name\":[18],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"band7_qa\"],\"name\":[19],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"atmospheric_correction\"],\"name\":[20],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"adjacency_correction\"],\"name\":[21],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"1073741824\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0000\",\"5\":\"0000\",\"6\":\"0000\",\"7\":\"0000\",\"8\":\"0000\",\"9\":\"0000\",\"10\":\"0000\",\"11\":\"00\",\"12\":\"ideal quality - all bands\",\"13\":\"highest_quality\",\"14\":\"highest_quality\",\"15\":\"highest_quality\",\"16\":\"highest_quality\",\"17\":\"highest_quality\",\"18\":\"highest_quality\",\"19\":\"highest_quality\",\"20\":\"yes\",\"21\":\"no\"},{\"1\":\"1073968181\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0000\",\"5\":\"0000\",\"6\":\"0000\",\"7\":\"1101\",\"8\":\"1101\",\"9\":\"0000\",\"10\":\"1101\",\"11\":\"01\",\"12\":\"less than ideal quality - some or all bands\",\"13\":\"correction out of bounds\",\"14\":\"highest_quality\",\"15\":\"correction out of bounds\",\"16\":\"correction out of bounds\",\"17\":\"highest_quality\",\"18\":\"highest_quality\",\"19\":\"highest_quality\",\"20\":\"yes\",\"21\":\"no\"},{\"1\":\"1073954817\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0000\",\"5\":\"0000\",\"6\":\"0000\",\"7\":\"1101\",\"8\":\"0000\",\"9\":\"0000\",\"10\":\"0000\",\"11\":\"01\",\"12\":\"less than ideal quality - some or all bands\",\"13\":\"highest_quality\",\"14\":\"highest_quality\",\"15\":\"highest_quality\",\"16\":\"correction out of bounds\",\"17\":\"highest_quality\",\"18\":\"highest_quality\",\"19\":\"highest_quality\",\"20\":\"yes\",\"21\":\"no\"},{\"1\":\"1075838976\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0000\",\"5\":\"0000\",\"6\":\"1000\",\"7\":\"0000\",\"8\":\"0000\",\"9\":\"0000\",\"10\":\"0000\",\"11\":\"00\",\"12\":\"ideal quality - all bands\",\"13\":\"highest_quality\",\"14\":\"highest_quality\",\"15\":\"highest_quality\",\"16\":\"highest_quality\",\"17\":\"dead detector, data interpolated in L1B\",\"18\":\"highest_quality\",\"19\":\"highest_quality\",\"20\":\"yes\",\"21\":\"no\"},{\"1\":\"1073968129\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0000\",\"5\":\"0000\",\"6\":\"0000\",\"7\":\"1101\",\"8\":\"1101\",\"9\":\"0000\",\"10\":\"0000\",\"11\":\"01\",\"12\":\"less than ideal quality - some or all bands\",\"13\":\"highest_quality\",\"14\":\"highest_quality\",\"15\":\"correction out of bounds\",\"16\":\"correction out of bounds\",\"17\":\"highest_quality\",\"18\":\"highest_quality\",\"19\":\"highest_quality\",\"20\":\"yes\",\"21\":\"no\"},{\"1\":\"1073755137\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0000\",\"5\":\"0000\",\"6\":\"0000\",\"7\":\"0000\",\"8\":\"1101\",\"9\":\"0000\",\"10\":\"0000\",\"11\":\"01\",\"12\":\"less than ideal quality - some or all bands\",\"13\":\"highest_quality\",\"14\":\"highest_quality\",\"15\":\"correction out of bounds\",\"16\":\"highest_quality\",\"17\":\"highest_quality\",\"18\":\"highest_quality\",\"19\":\"highest_quality\",\"20\":\"yes\",\"21\":\"no\"},{\"1\":\"1073755189\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0000\",\"5\":\"0000\",\"6\":\"0000\",\"7\":\"0000\",\"8\":\"1101\",\"9\":\"0000\",\"10\":\"1101\",\"11\":\"01\",\"12\":\"less than ideal quality - some or all bands\",\"13\":\"correction out of bounds\",\"14\":\"highest_quality\",\"15\":\"correction out of bounds\",\"16\":\"highest_quality\",\"17\":\"highest_quality\",\"18\":\"highest_quality\",\"19\":\"highest_quality\",\"20\":\"yes\",\"21\":\"no\"},{\"1\":\"1075852341\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0000\",\"5\":\"0000\",\"6\":\"1000\",\"7\":\"0000\",\"8\":\"1101\",\"9\":\"0000\",\"10\":\"1101\",\"11\":\"01\",\"12\":\"less than ideal quality - some or all bands\",\"13\":\"correction out of bounds\",\"14\":\"highest_quality\",\"15\":\"correction out of bounds\",\"16\":\"highest_quality\",\"17\":\"dead detector, data interpolated in L1B\",\"18\":\"highest_quality\",\"19\":\"highest_quality\",\"20\":\"yes\",\"21\":\"no\"},{\"1\":\"1076065281\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0000\",\"5\":\"0000\",\"6\":\"1000\",\"7\":\"1101\",\"8\":\"1101\",\"9\":\"0000\",\"10\":\"0000\",\"11\":\"01\",\"12\":\"less than ideal quality - some or all bands\",\"13\":\"highest_quality\",\"14\":\"highest_quality\",\"15\":\"correction out of bounds\",\"16\":\"correction out of bounds\",\"17\":\"dead detector, data interpolated in L1B\",\"18\":\"highest_quality\",\"19\":\"highest_quality\",\"20\":\"yes\",\"21\":\"no\"},{\"1\":\"1946383413\",\"2\":\"0\",\"3\":\"1\",\"4\":\"1101\",\"5\":\"0000\",\"6\":\"0000\",\"7\":\"1101\",\"8\":\"1101\",\"9\":\"0000\",\"10\":\"1101\",\"11\":\"01\",\"12\":\"less than ideal quality - some or all bands\",\"13\":\"correction out of bounds\",\"14\":\"highest_quality\",\"15\":\"correction out of bounds\",\"16\":\"correction out of bounds\",\"17\":\"highest_quality\",\"18\":\"highest_quality\",\"19\":\"correction out of bounds\",\"20\":\"yes\",\"21\":\"no\"},{\"1\":\"1073969013\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0000\",\"5\":\"0000\",\"6\":\"0000\",\"7\":\"1101\",\"8\":\"1101\",\"9\":\"1101\",\"10\":\"1101\",\"11\":\"01\",\"12\":\"less than ideal quality - some or all bands\",\"13\":\"correction out of bounds\",\"14\":\"correction out of bounds\",\"15\":\"correction out of bounds\",\"16\":\"correction out of bounds\",\"17\":\"highest_quality\",\"18\":\"highest_quality\",\"19\":\"highest_quality\",\"20\":\"yes\",\"21\":\"no\"},{\"1\":\"1073954869\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0000\",\"5\":\"0000\",\"6\":\"0000\",\"7\":\"1101\",\"8\":\"0000\",\"9\":\"0000\",\"10\":\"1101\",\"11\":\"01\",\"12\":\"less than ideal quality - some or all bands\",\"13\":\"correction out of bounds\",\"14\":\"highest_quality\",\"15\":\"highest_quality\",\"16\":\"correction out of bounds\",\"17\":\"highest_quality\",\"18\":\"highest_quality\",\"19\":\"highest_quality\",\"20\":\"yes\",\"21\":\"no\"},{\"1\":\"1075852289\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0000\",\"5\":\"0000\",\"6\":\"1000\",\"7\":\"0000\",\"8\":\"1101\",\"9\":\"0000\",\"10\":\"0000\",\"11\":\"01\",\"12\":\"less than ideal quality - some or all bands\",\"13\":\"highest_quality\",\"14\":\"highest_quality\",\"15\":\"correction out of bounds\",\"16\":\"highest_quality\",\"17\":\"dead detector, data interpolated in L1B\",\"18\":\"highest_quality\",\"19\":\"highest_quality\",\"20\":\"yes\",\"21\":\"no\"},{\"1\":\"1076065333\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0000\",\"5\":\"0000\",\"6\":\"1000\",\"7\":\"1101\",\"8\":\"1101\",\"9\":\"0000\",\"10\":\"1101\",\"11\":\"01\",\"12\":\"less than ideal quality - some or all bands\",\"13\":\"correction out of bounds\",\"14\":\"highest_quality\",\"15\":\"correction out of bounds\",\"16\":\"correction out of bounds\",\"17\":\"dead detector, data interpolated in L1B\",\"18\":\"highest_quality\",\"19\":\"highest_quality\",\"20\":\"yes\",\"21\":\"no\"},{\"1\":\"1076051969\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0000\",\"5\":\"0000\",\"6\":\"1000\",\"7\":\"1101\",\"8\":\"0000\",\"9\":\"0000\",\"10\":\"0000\",\"11\":\"01\",\"12\":\"less than ideal quality - some or all bands\",\"13\":\"highest_quality\",\"14\":\"highest_quality\",\"15\":\"highest_quality\",\"16\":\"correction out of bounds\",\"17\":\"dead detector, data interpolated in L1B\",\"18\":\"highest_quality\",\"19\":\"highest_quality\",\"20\":\"yes\",\"21\":\"no\"},{\"1\":\"1075576832\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0000\",\"5\":\"0000\",\"6\":\"0111\",\"7\":\"0000\",\"8\":\"0000\",\"9\":\"0000\",\"10\":\"0000\",\"11\":\"00\",\"12\":\"ideal quality - all bands\",\"13\":\"highest_quality\",\"14\":\"highest_quality\",\"15\":\"highest_quality\",\"16\":\"highest_quality\",\"17\":\"noisy detector\",\"18\":\"highest_quality\",\"19\":\"highest_quality\",\"20\":\"yes\",\"21\":\"no\"},{\"1\":\"1075590145\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0000\",\"5\":\"0000\",\"6\":\"0111\",\"7\":\"0000\",\"8\":\"1101\",\"9\":\"0000\",\"10\":\"0000\",\"11\":\"01\",\"12\":\"less than ideal quality - some or all bands\",\"13\":\"highest_quality\",\"14\":\"highest_quality\",\"15\":\"correction out of bounds\",\"16\":\"highest_quality\",\"17\":\"noisy detector\",\"18\":\"highest_quality\",\"19\":\"highest_quality\",\"20\":\"yes\",\"21\":\"no\"},{\"1\":\"1075803189\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0000\",\"5\":\"0000\",\"6\":\"0111\",\"7\":\"1101\",\"8\":\"1101\",\"9\":\"0000\",\"10\":\"1101\",\"11\":\"01\",\"12\":\"less than ideal quality - some or all bands\",\"13\":\"correction out of bounds\",\"14\":\"highest_quality\",\"15\":\"correction out of bounds\",\"16\":\"correction out of bounds\",\"17\":\"noisy detector\",\"18\":\"highest_quality\",\"19\":\"highest_quality\",\"20\":\"yes\",\"21\":\"no\"},{\"1\":\"1131675649\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0000\",\"5\":\"1101\",\"6\":\"1101\",\"7\":\"0000\",\"8\":\"0000\",\"9\":\"0000\",\"10\":\"0000\",\"11\":\"01\",\"12\":\"less than ideal quality - some or all bands\",\"13\":\"highest_quality\",\"14\":\"highest_quality\",\"15\":\"highest_quality\",\"16\":\"highest_quality\",\"17\":\"correction out of bounds\",\"18\":\"correction out of bounds\",\"19\":\"highest_quality\",\"20\":\"yes\",\"21\":\"no\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\nThat's a big table, so to understand better, let's check just the MODLAND QA \nbits categorization:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqc_500_description |> \n        select(modland, modland_qa, qc_ints) |> \n        paged_table()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"modland\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"modland_qa\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"qc_ints\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"00\",\"2\":\"ideal quality - all bands\",\"3\":\"1073741824\"},{\"1\":\"01\",\"2\":\"less than ideal quality - some or all bands\",\"3\":\"1073968181\"},{\"1\":\"01\",\"2\":\"less than ideal quality - some or all bands\",\"3\":\"1073954817\"},{\"1\":\"00\",\"2\":\"ideal quality - all bands\",\"3\":\"1075838976\"},{\"1\":\"01\",\"2\":\"less than ideal quality - some or all bands\",\"3\":\"1073968129\"},{\"1\":\"01\",\"2\":\"less than ideal quality - some or all bands\",\"3\":\"1073755137\"},{\"1\":\"01\",\"2\":\"less than ideal quality - some or all bands\",\"3\":\"1073755189\"},{\"1\":\"01\",\"2\":\"less than ideal quality - some or all bands\",\"3\":\"1075852341\"},{\"1\":\"01\",\"2\":\"less than ideal quality - some or all bands\",\"3\":\"1076065281\"},{\"1\":\"01\",\"2\":\"less than ideal quality - some or all bands\",\"3\":\"1946383413\"},{\"1\":\"01\",\"2\":\"less than ideal quality - some or all bands\",\"3\":\"1073969013\"},{\"1\":\"01\",\"2\":\"less than ideal quality - some or all bands\",\"3\":\"1073954869\"},{\"1\":\"01\",\"2\":\"less than ideal quality - some or all bands\",\"3\":\"1075852289\"},{\"1\":\"01\",\"2\":\"less than ideal quality - some or all bands\",\"3\":\"1076065333\"},{\"1\":\"01\",\"2\":\"less than ideal quality - some or all bands\",\"3\":\"1076051969\"},{\"1\":\"00\",\"2\":\"ideal quality - all bands\",\"3\":\"1075576832\"},{\"1\":\"01\",\"2\":\"less than ideal quality - some or all bands\",\"3\":\"1075590145\"},{\"1\":\"01\",\"2\":\"less than ideal quality - some or all bands\",\"3\":\"1075803189\"},{\"1\":\"01\",\"2\":\"less than ideal quality - some or all bands\",\"3\":\"1131675649\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n![](images/modland_qa.png)\n\nFrom our dataset, we obtained two of the categories from the \ntotal 4. The `qc_ints` have 19 different observations in total, but those \nintegers will give us information for the rest of the parameters.\n\n<!-- Is there a way to establish the same code for the bands given that they have -->\n<!-- the same categories? -->\n\n## Proof of concept for 16 bits\n\nSo far we have all the steps to perform the binary conversion for a variable\nthat consist on 32 bits. Nonetheless, other variables could use less bits such\nas `state_1km` which uses **16 bits**. Here, I'm going to apply the same process\ndescribed above to this variable but with some changes in the code indicating \nthe quantity of bits to be used.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Check unique values and add one validation (from the video)\nqc_data <- data.frame(qc_ints = c(unique(reflectance_500$state_1km),\n                                  1131675649))\n\n## Create empty data frame. This case is 32 given that the variable\n## `qc_500m` have 32 bits\nfor (i in c(15:0)) {\n  qc_data[, paste0(\"bit_\", i)] <- NA\n}\n\n# Loop for obtaining bit string from unique values in the variable\nz <- 1\nfor (i in qc_data$qc_ints) {\n  # print(i)\n  transformed <- as.integer(intToBits(i)[1:16])\n  qc_data[z, 2:17] <- transformed[16:1]\n  z <- z + 1\n}\n\n## Create test according to value in video\nprocess_test <- qc_data |> \n  filter(qc_ints == 1131675649) |>\n  select(-qc_ints) |>\n  unite(col = \"new\", bit_15:bit_0, sep = \"\") |> \n  pull() \n\nstopifnot(process_test == \"0000000000000001\")\n```\n:::\n\n\nLooks like we were able to succesfuly pass our test. Let's check how the\ndataset with the binary conversion looks like:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npaged_table(qc_data)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"qc_ints\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"bit_15\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_14\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_13\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_12\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_11\"],\"name\":[6],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_10\"],\"name\":[7],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_9\"],\"name\":[8],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_8\"],\"name\":[9],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_7\"],\"name\":[10],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_6\"],\"name\":[11],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_5\"],\"name\":[12],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_4\"],\"name\":[13],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_3\"],\"name\":[14],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_2\"],\"name\":[15],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_1\"],\"name\":[16],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_0\"],\"name\":[17],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1033\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"1\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"1\"},{\"1\":\"40969\",\"2\":\"1\",\"3\":\"0\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"1\"},{\"1\":\"8392\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"1\",\"11\":\"1\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"1034\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"1\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"1\",\"17\":\"0\"},{\"1\":\"40970\",\"2\":\"1\",\"3\":\"0\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"1\",\"17\":\"0\"},{\"1\":\"5384\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"1\",\"6\":\"0\",\"7\":\"1\",\"8\":\"0\",\"9\":\"1\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"1289\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"1\",\"8\":\"0\",\"9\":\"1\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"1\"},{\"1\":\"1801\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"1\"},{\"1\":\"45068\",\"2\":\"1\",\"3\":\"0\",\"4\":\"1\",\"5\":\"1\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"1\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"1545\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"1\",\"8\":\"1\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"1\"},{\"1\":\"8397\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"1\",\"11\":\"1\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"1\",\"16\":\"0\",\"17\":\"1\"},{\"1\":\"8398\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"1\",\"11\":\"1\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"1\",\"16\":\"1\",\"17\":\"0\"},{\"1\":\"1032\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"1\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"8396\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"1\",\"11\":\"1\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"1\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"8393\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"1\",\"11\":\"1\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"1\"},{\"1\":\"5128\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"1\",\"6\":\"0\",\"7\":\"1\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"40973\",\"2\":\"1\",\"3\":\"0\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"1\",\"16\":\"0\",\"17\":\"1\"},{\"1\":\"40974\",\"2\":\"1\",\"3\":\"0\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"1\",\"16\":\"1\",\"17\":\"0\"},{\"1\":\"45064\",\"2\":\"1\",\"3\":\"0\",\"4\":\"1\",\"5\":\"1\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"8394\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"1\",\"11\":\"1\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"1\",\"17\":\"0\"},{\"1\":\"32781\",\"2\":\"1\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"1\",\"16\":\"0\",\"17\":\"1\"},{\"1\":\"206\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"1\",\"11\":\"1\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"1\",\"16\":\"1\",\"17\":\"0\"},{\"1\":\"36872\",\"2\":\"1\",\"3\":\"0\",\"4\":\"0\",\"5\":\"1\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"32778\",\"2\":\"1\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"1\",\"17\":\"0\"},{\"1\":\"32777\",\"2\":\"1\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"1\"},{\"1\":\"5640\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"1\",\"6\":\"0\",\"7\":\"1\",\"8\":\"1\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"36876\",\"2\":\"1\",\"3\":\"0\",\"4\":\"0\",\"5\":\"1\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"1\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"32776\",\"2\":\"1\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"45066\",\"2\":\"1\",\"3\":\"0\",\"4\":\"1\",\"5\":\"1\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"1\",\"17\":\"0\"},{\"1\":\"8334\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"1\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"1\",\"16\":\"1\",\"17\":\"0\"},{\"1\":\"200\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"1\",\"11\":\"1\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"138\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"1\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"1\",\"17\":\"0\"},{\"1\":\"136\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"1\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"8\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"72\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"1\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"8264\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"1\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"1544\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"1\",\"8\":\"1\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"8332\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"1\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"1\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"1802\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"1\",\"17\":\"0\"},{\"1\":\"1288\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"1\",\"8\":\"0\",\"9\":\"1\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"8328\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"1\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"1546\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"1\",\"8\":\"1\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"1\",\"17\":\"0\"},{\"1\":\"8268\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"1\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"1\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"8330\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"1\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"1\",\"17\":\"0\"},{\"1\":\"8205\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"1\",\"16\":\"0\",\"17\":\"1\"},{\"1\":\"76\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"1\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"1\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"204\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"1\",\"11\":\"1\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"1\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"141\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"1\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"1\",\"16\":\"0\",\"17\":\"1\"},{\"1\":\"140\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"1\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"1\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"8204\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"1\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"40972\",\"2\":\"1\",\"3\":\"0\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"1\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"8266\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"1\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"1\",\"17\":\"0\"},{\"1\":\"137\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"1\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"1\"},{\"1\":\"1290\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"1\",\"8\":\"0\",\"9\":\"1\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"1\",\"17\":\"0\"},{\"1\":\"74\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"1\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"1\",\"17\":\"0\"},{\"1\":\"1800\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"32780\",\"2\":\"1\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"1\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"5896\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"1\",\"6\":\"0\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"40968\",\"2\":\"1\",\"3\":\"0\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\"},{\"1\":\"205\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"1\",\"11\":\"1\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"1\",\"16\":\"0\",\"17\":\"1\"},{\"1\":\"202\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"1\",\"11\":\"1\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"1\",\"17\":\"0\"},{\"1\":\"201\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"1\",\"11\":\"1\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"1\"},{\"1\":\"8329\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"1\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"1\"},{\"1\":\"8270\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"1\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"1\",\"16\":\"1\",\"17\":\"0\"},{\"1\":\"5385\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"1\",\"6\":\"0\",\"7\":\"1\",\"8\":\"0\",\"9\":\"1\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"1\"},{\"1\":\"5898\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"1\",\"6\":\"0\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"1\",\"17\":\"0\"},{\"1\":\"5642\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"1\",\"6\":\"0\",\"7\":\"1\",\"8\":\"1\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"1\",\"17\":\"0\"},{\"1\":\"1131675649\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n# Create function for bit string conversion\n\nAt this point I have the skeleton of the code needed to create a function to be\napplied to the next variables. It has to take into account the variable and the \nnumber of bits to be used in the bit mask conversion.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Transform this to a function\nobtain_bit_qc_df <- function(variable, bits) {\n  \n  ## Check unique values and add one validation (from the video)\n  qc_data <- data.frame(qc_ints = c(unique(reflectance_500[[variable]]),\n                                    1131675649))\n  \n  ## Create empty data frame. This case is 32 given that the variable\n  ## `qc_500m` have 32 bits\n  total_bits = bits - 1\n  for (i in c(total_bits:0)) {\n    qc_data[, paste0(\"bit_\", i)] <- NA\n  }\n  \n  # Loop for obtaining bit string from unique values in the variable\n  bit_col <- bits + 1\n  z <- 1\n  for (i in qc_data$qc_ints) {\n    # print(i)\n    transformed <- as.integer(intToBits(i)[1:bits])\n    qc_data[z, 2:bit_col] <- transformed[bits:1]\n    z <- z + 1\n  }\n \n  ## Create test according to value in video\n  final_bit <- paste0(\"bit_\", total_bits)\n  \n  process_test <- qc_data |> \n    filter(qc_ints == 1131675649) |>\n    select(-qc_ints) |>\n    unite(col = \"new\", everything(), sep = \"\") |> \n    pull() \n  \n  test_object <- stringr::str_sub(\"01000011011101000000000000000001\",\n                                  start = -bits, end = -1)\n\n  stopifnot(process_test == test_object) \n  \n  return(qc_data)\n}\n```\n:::\n\n\nLet's use the function on the `state_1km` variable to check if it works. Then, \nlet's compare the result with the dataset we create step by step to validate\nif we can obtain the same result.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Obtain the bit string using the function\nqc_data_function <- obtain_bit_qc_df(variable = \"state_1km\", bits = 16)\n\n# Compare last qc_data from state_1km and new qc_data created with function\nstopifnot(qc_data$bit_14 == qc_data_function$bit_14)\n\n# Check dimensions\nstopifnot(dim(qc_data) == dim(qc_data_function))\n```\n:::\n\n\nSeems that it works! With the function we obtained the same dimensions of the\ndataset than before. Let's now create the categories for each of the bit strings\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create the categories according to documentation\nstate_1km__description <- qc_data_function |> \n  unite(col = \"cloud_state\", c(\"bit_1\", \"bit_0\"), sep = \"\") |> \n  unite(col = \"land_water_flag\",\n        c(\"bit_5\", \"bit_4\", \"bit_3\"), sep = \"\") |>\n  unite(col = \"aerosol_quantity\",\n        c(\"bit_7\", \"bit_6\"), sep = \"\") |>\n  unite(col = \"cirrus_detected\",\n        c(\"bit_9\", \"bit_8\"), sep = \"\") |>\n  mutate(cloud_state_qa = case_when(\n    cloud_state == \"00\" ~ \"clear\",\n    cloud_state == \"01\" ~ \"cloudy\",\n    cloud_state == \"10\" ~ \"mixed\",\n    cloud_state == \"11\" ~ \"not set, assumed clear\",\n    TRUE ~ \"No info, please validate bit conversion\"\n  )) |> \n  mutate(cloud_shadow_qa = ifelse(bit_2 == 1, \"yes\", \"no\")) |> \n    mutate(land_water_qa = case_when(\n    land_water_flag == \"000\" ~ \"shallow ocean\",\n    land_water_flag == \"001\" ~ \"land\",\n    land_water_flag == \"010\" ~ \"ocean coastlines and lake shorelines\",\n    land_water_flag == \"011\" ~ \"shallow inland water\",\n    land_water_flag == \"100\" ~ \"ephemeral water\",\n    land_water_flag == \"101\" ~ \"deep inland water\",\n    land_water_flag == \"110\" ~ \"continental/moderate ocean\",\n    land_water_flag == \"111\" ~ \"deep ocean\",\n    TRUE ~ \"No info, please validate bit conversion\"\n  )) |> \n    mutate(aerosol_quantity_qa = case_when(\n    aerosol_quantity == \"00\" ~ \"climatology\",\n    aerosol_quantity == \"01\" ~ \"low\",\n    aerosol_quantity == \"10\" ~ \"average\",\n    aerosol_quantity == \"11\" ~ \"high\",\n    TRUE ~ \"No info, please validate bit conversion\"\n  )) |> \n    mutate(cirrus_detected_qa = case_when(\n    cirrus_detected == \"00\" ~ \"none\",\n    cirrus_detected == \"01\" ~ \"small\",\n    cirrus_detected == \"10\" ~ \"average\",\n    cirrus_detected == \"11\" ~ \"high\",\n    TRUE ~ \"No info, please validate bit conversion\"\n  )) |> \n  mutate(cloud_flag_qa = ifelse(bit_10 == 1, \"cloud\", \"no cloud\"),\n         fire_flag_qa = ifelse(bit_11 == 1, \"fire\", \"no fire\"),\n         snow_ice_flag_qa = ifelse(bit_12 == 1, \"yes\", \"no\"),\n         pixel_adjacent_cloud_qa = ifelse(bit_13 == 1, \"yes\", \"no\"),\n         salt_pan_qa = ifelse(bit_14 == 1, \"yes\", \"no\"),\n         snow_mask_qa = ifelse(bit_15 == 1, \"yes\", \"no\"))\n```\n:::\n\n\nNow, let's check the resulting dataset:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstate_1km__description |> \n        select(-starts_with(\"bit\")) |> \n        paged_table()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"qc_ints\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"cirrus_detected\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"aerosol_quantity\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"land_water_flag\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"cloud_state\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"cloud_state_qa\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"cloud_shadow_qa\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"land_water_qa\"],\"name\":[8],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"aerosol_quantity_qa\"],\"name\":[9],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"cirrus_detected_qa\"],\"name\":[10],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"cloud_flag_qa\"],\"name\":[11],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"fire_flag_qa\"],\"name\":[12],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"snow_ice_flag_qa\"],\"name\":[13],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"pixel_adjacent_cloud_qa\"],\"name\":[14],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"salt_pan_qa\"],\"name\":[15],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"snow_mask_qa\"],\"name\":[16],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"1033\",\"2\":\"00\",\"3\":\"00\",\"4\":\"001\",\"5\":\"01\",\"6\":\"cloudy\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"40969\",\"2\":\"00\",\"3\":\"00\",\"4\":\"001\",\"5\":\"01\",\"6\":\"cloudy\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"yes\"},{\"1\":\"8392\",\"2\":\"00\",\"3\":\"11\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"no\",\"8\":\"land\",\"9\":\"high\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"1034\",\"2\":\"00\",\"3\":\"00\",\"4\":\"001\",\"5\":\"10\",\"6\":\"mixed\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"40970\",\"2\":\"00\",\"3\":\"00\",\"4\":\"001\",\"5\":\"10\",\"6\":\"mixed\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"yes\"},{\"1\":\"5384\",\"2\":\"01\",\"3\":\"00\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"small\",\"11\":\"cloud\",\"12\":\"no fire\",\"13\":\"yes\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"1289\",\"2\":\"01\",\"3\":\"00\",\"4\":\"001\",\"5\":\"01\",\"6\":\"cloudy\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"small\",\"11\":\"cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"1801\",\"2\":\"11\",\"3\":\"00\",\"4\":\"001\",\"5\":\"01\",\"6\":\"cloudy\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"high\",\"11\":\"cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"45068\",\"2\":\"00\",\"3\":\"00\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"yes\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"yes\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"yes\"},{\"1\":\"1545\",\"2\":\"10\",\"3\":\"00\",\"4\":\"001\",\"5\":\"01\",\"6\":\"cloudy\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"average\",\"11\":\"cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"8397\",\"2\":\"00\",\"3\":\"11\",\"4\":\"001\",\"5\":\"01\",\"6\":\"cloudy\",\"7\":\"yes\",\"8\":\"land\",\"9\":\"high\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"8398\",\"2\":\"00\",\"3\":\"11\",\"4\":\"001\",\"5\":\"10\",\"6\":\"mixed\",\"7\":\"yes\",\"8\":\"land\",\"9\":\"high\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"1032\",\"2\":\"00\",\"3\":\"00\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"8396\",\"2\":\"00\",\"3\":\"11\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"yes\",\"8\":\"land\",\"9\":\"high\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"8393\",\"2\":\"00\",\"3\":\"11\",\"4\":\"001\",\"5\":\"01\",\"6\":\"cloudy\",\"7\":\"no\",\"8\":\"land\",\"9\":\"high\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"5128\",\"2\":\"00\",\"3\":\"00\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"cloud\",\"12\":\"no fire\",\"13\":\"yes\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"40973\",\"2\":\"00\",\"3\":\"00\",\"4\":\"001\",\"5\":\"01\",\"6\":\"cloudy\",\"7\":\"yes\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"yes\"},{\"1\":\"40974\",\"2\":\"00\",\"3\":\"00\",\"4\":\"001\",\"5\":\"10\",\"6\":\"mixed\",\"7\":\"yes\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"yes\"},{\"1\":\"45064\",\"2\":\"00\",\"3\":\"00\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"yes\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"yes\"},{\"1\":\"8394\",\"2\":\"00\",\"3\":\"11\",\"4\":\"001\",\"5\":\"10\",\"6\":\"mixed\",\"7\":\"no\",\"8\":\"land\",\"9\":\"high\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"32781\",\"2\":\"00\",\"3\":\"00\",\"4\":\"001\",\"5\":\"01\",\"6\":\"cloudy\",\"7\":\"yes\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"yes\"},{\"1\":\"206\",\"2\":\"00\",\"3\":\"11\",\"4\":\"001\",\"5\":\"10\",\"6\":\"mixed\",\"7\":\"yes\",\"8\":\"land\",\"9\":\"high\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"36872\",\"2\":\"00\",\"3\":\"00\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"yes\",\"14\":\"no\",\"15\":\"no\",\"16\":\"yes\"},{\"1\":\"32778\",\"2\":\"00\",\"3\":\"00\",\"4\":\"001\",\"5\":\"10\",\"6\":\"mixed\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"yes\"},{\"1\":\"32777\",\"2\":\"00\",\"3\":\"00\",\"4\":\"001\",\"5\":\"01\",\"6\":\"cloudy\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"yes\"},{\"1\":\"5640\",\"2\":\"10\",\"3\":\"00\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"average\",\"11\":\"cloud\",\"12\":\"no fire\",\"13\":\"yes\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"36876\",\"2\":\"00\",\"3\":\"00\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"yes\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"yes\",\"14\":\"no\",\"15\":\"no\",\"16\":\"yes\"},{\"1\":\"32776\",\"2\":\"00\",\"3\":\"00\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"yes\"},{\"1\":\"45066\",\"2\":\"00\",\"3\":\"00\",\"4\":\"001\",\"5\":\"10\",\"6\":\"mixed\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"yes\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"yes\"},{\"1\":\"8334\",\"2\":\"00\",\"3\":\"10\",\"4\":\"001\",\"5\":\"10\",\"6\":\"mixed\",\"7\":\"yes\",\"8\":\"land\",\"9\":\"average\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"200\",\"2\":\"00\",\"3\":\"11\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"no\",\"8\":\"land\",\"9\":\"high\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"138\",\"2\":\"00\",\"3\":\"10\",\"4\":\"001\",\"5\":\"10\",\"6\":\"mixed\",\"7\":\"no\",\"8\":\"land\",\"9\":\"average\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"136\",\"2\":\"00\",\"3\":\"10\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"no\",\"8\":\"land\",\"9\":\"average\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"8\",\"2\":\"00\",\"3\":\"00\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"72\",\"2\":\"00\",\"3\":\"01\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"no\",\"8\":\"land\",\"9\":\"low\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"8264\",\"2\":\"00\",\"3\":\"01\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"no\",\"8\":\"land\",\"9\":\"low\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"1544\",\"2\":\"10\",\"3\":\"00\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"average\",\"11\":\"cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"8332\",\"2\":\"00\",\"3\":\"10\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"yes\",\"8\":\"land\",\"9\":\"average\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"1802\",\"2\":\"11\",\"3\":\"00\",\"4\":\"001\",\"5\":\"10\",\"6\":\"mixed\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"high\",\"11\":\"cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"1288\",\"2\":\"01\",\"3\":\"00\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"small\",\"11\":\"cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"8328\",\"2\":\"00\",\"3\":\"10\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"no\",\"8\":\"land\",\"9\":\"average\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"1546\",\"2\":\"10\",\"3\":\"00\",\"4\":\"001\",\"5\":\"10\",\"6\":\"mixed\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"average\",\"11\":\"cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"8268\",\"2\":\"00\",\"3\":\"01\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"yes\",\"8\":\"land\",\"9\":\"low\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"8330\",\"2\":\"00\",\"3\":\"10\",\"4\":\"001\",\"5\":\"10\",\"6\":\"mixed\",\"7\":\"no\",\"8\":\"land\",\"9\":\"average\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"8205\",\"2\":\"00\",\"3\":\"00\",\"4\":\"001\",\"5\":\"01\",\"6\":\"cloudy\",\"7\":\"yes\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"76\",\"2\":\"00\",\"3\":\"01\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"yes\",\"8\":\"land\",\"9\":\"low\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"204\",\"2\":\"00\",\"3\":\"11\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"yes\",\"8\":\"land\",\"9\":\"high\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"141\",\"2\":\"00\",\"3\":\"10\",\"4\":\"001\",\"5\":\"01\",\"6\":\"cloudy\",\"7\":\"yes\",\"8\":\"land\",\"9\":\"average\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"140\",\"2\":\"00\",\"3\":\"10\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"yes\",\"8\":\"land\",\"9\":\"average\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"8204\",\"2\":\"00\",\"3\":\"00\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"yes\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"40972\",\"2\":\"00\",\"3\":\"00\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"yes\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"yes\"},{\"1\":\"8266\",\"2\":\"00\",\"3\":\"01\",\"4\":\"001\",\"5\":\"10\",\"6\":\"mixed\",\"7\":\"no\",\"8\":\"land\",\"9\":\"low\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"137\",\"2\":\"00\",\"3\":\"10\",\"4\":\"001\",\"5\":\"01\",\"6\":\"cloudy\",\"7\":\"no\",\"8\":\"land\",\"9\":\"average\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"1290\",\"2\":\"01\",\"3\":\"00\",\"4\":\"001\",\"5\":\"10\",\"6\":\"mixed\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"small\",\"11\":\"cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"74\",\"2\":\"00\",\"3\":\"01\",\"4\":\"001\",\"5\":\"10\",\"6\":\"mixed\",\"7\":\"no\",\"8\":\"land\",\"9\":\"low\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"1800\",\"2\":\"11\",\"3\":\"00\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"high\",\"11\":\"cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"32780\",\"2\":\"00\",\"3\":\"00\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"yes\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"yes\"},{\"1\":\"5896\",\"2\":\"11\",\"3\":\"00\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"high\",\"11\":\"cloud\",\"12\":\"no fire\",\"13\":\"yes\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"40968\",\"2\":\"00\",\"3\":\"00\",\"4\":\"001\",\"5\":\"00\",\"6\":\"clear\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"yes\"},{\"1\":\"205\",\"2\":\"00\",\"3\":\"11\",\"4\":\"001\",\"5\":\"01\",\"6\":\"cloudy\",\"7\":\"yes\",\"8\":\"land\",\"9\":\"high\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"202\",\"2\":\"00\",\"3\":\"11\",\"4\":\"001\",\"5\":\"10\",\"6\":\"mixed\",\"7\":\"no\",\"8\":\"land\",\"9\":\"high\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"201\",\"2\":\"00\",\"3\":\"11\",\"4\":\"001\",\"5\":\"01\",\"6\":\"cloudy\",\"7\":\"no\",\"8\":\"land\",\"9\":\"high\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"8329\",\"2\":\"00\",\"3\":\"10\",\"4\":\"001\",\"5\":\"01\",\"6\":\"cloudy\",\"7\":\"no\",\"8\":\"land\",\"9\":\"average\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"8270\",\"2\":\"00\",\"3\":\"01\",\"4\":\"001\",\"5\":\"10\",\"6\":\"mixed\",\"7\":\"yes\",\"8\":\"land\",\"9\":\"low\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"yes\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"5385\",\"2\":\"01\",\"3\":\"00\",\"4\":\"001\",\"5\":\"01\",\"6\":\"cloudy\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"small\",\"11\":\"cloud\",\"12\":\"no fire\",\"13\":\"yes\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"5898\",\"2\":\"11\",\"3\":\"00\",\"4\":\"001\",\"5\":\"10\",\"6\":\"mixed\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"high\",\"11\":\"cloud\",\"12\":\"no fire\",\"13\":\"yes\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"5642\",\"2\":\"10\",\"3\":\"00\",\"4\":\"001\",\"5\":\"10\",\"6\":\"mixed\",\"7\":\"no\",\"8\":\"land\",\"9\":\"climatology\",\"10\":\"average\",\"11\":\"cloud\",\"12\":\"no fire\",\"13\":\"yes\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"},{\"1\":\"1131675649\",\"2\":\"00\",\"3\":\"00\",\"4\":\"000\",\"5\":\"01\",\"6\":\"cloudy\",\"7\":\"no\",\"8\":\"shallow ocean\",\"9\":\"climatology\",\"10\":\"none\",\"11\":\"no cloud\",\"12\":\"no fire\",\"13\":\"no\",\"14\":\"no\",\"15\":\"no\",\"16\":\"no\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n### q_scan\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Obtain the bit string\nqc_data <- obtain_bit_qc_df(variable = \"q_scan\", bits = 8)\n\n# Create the categories according to documentation\nq_scan_description <- qc_data |> \n  mutate(scan_quadrant_1 = ifelse(bit_0 == 1, \"yes\", \"no\"),\n         scan_quadrant_2 = ifelse(bit_0 == 1, \"yes\", \"no\"),\n         scan_quadrant_3 = ifelse(bit_0 == 1, \"yes\", \"no\"),\n         scan_quadrant_4 = ifelse(bit_0 == 1, \"yes\", \"no\"),\n         missing_obs_1 = ifelse(bit_1 == 1, \"same\", \"different\"),\n         missing_obs_2 = ifelse(bit_1 == 1, \"same\", \"different\"),\n         missing_obs_3 = ifelse(bit_1 == 1, \"same\", \"different\"),\n         missing_obs_4 = ifelse(bit_1 == 1, \"same\", \"different\"))\n\nq_scan_description |> \n        paged_table()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"qc_ints\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"bit_7\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_6\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_5\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_4\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_3\"],\"name\":[6],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_2\"],\"name\":[7],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_1\"],\"name\":[8],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"bit_0\"],\"name\":[9],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"scan_quadrant_1\"],\"name\":[10],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"scan_quadrant_2\"],\"name\":[11],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"scan_quadrant_3\"],\"name\":[12],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"scan_quadrant_4\"],\"name\":[13],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"missing_obs_1\"],\"name\":[14],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"missing_obs_2\"],\"name\":[15],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"missing_obs_3\"],\"name\":[16],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"missing_obs_4\"],\"name\":[17],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"14\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"1\",\"7\":\"1\",\"8\":\"1\",\"9\":\"0\",\"10\":\"no\",\"11\":\"no\",\"12\":\"no\",\"13\":\"no\",\"14\":\"same\",\"15\":\"same\",\"16\":\"same\",\"17\":\"same\"},{\"1\":\"8\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"1\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"no\",\"11\":\"no\",\"12\":\"no\",\"13\":\"no\",\"14\":\"different\",\"15\":\"different\",\"16\":\"different\",\"17\":\"different\"},{\"1\":\"9\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"1\",\"7\":\"0\",\"8\":\"0\",\"9\":\"1\",\"10\":\"yes\",\"11\":\"yes\",\"12\":\"yes\",\"13\":\"yes\",\"14\":\"different\",\"15\":\"different\",\"16\":\"different\",\"17\":\"different\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"1\",\"9\":\"0\",\"10\":\"no\",\"11\":\"no\",\"12\":\"no\",\"13\":\"no\",\"14\":\"same\",\"15\":\"same\",\"16\":\"same\",\"17\":\"same\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"no\",\"11\":\"no\",\"12\":\"no\",\"13\":\"no\",\"14\":\"different\",\"15\":\"different\",\"16\":\"different\",\"17\":\"different\"},{\"1\":\"6\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"1\",\"8\":\"1\",\"9\":\"0\",\"10\":\"no\",\"11\":\"no\",\"12\":\"no\",\"13\":\"no\",\"14\":\"same\",\"15\":\"same\",\"16\":\"same\",\"17\":\"same\"},{\"1\":\"15\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"1\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"yes\",\"11\":\"yes\",\"12\":\"yes\",\"13\":\"yes\",\"14\":\"same\",\"15\":\"same\",\"16\":\"same\",\"17\":\"same\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"1\",\"9\":\"1\",\"10\":\"yes\",\"11\":\"yes\",\"12\":\"yes\",\"13\":\"yes\",\"14\":\"same\",\"15\":\"same\",\"16\":\"same\",\"17\":\"same\"},{\"1\":\"13\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"1\",\"7\":\"1\",\"8\":\"0\",\"9\":\"1\",\"10\":\"yes\",\"11\":\"yes\",\"12\":\"yes\",\"13\":\"yes\",\"14\":\"different\",\"15\":\"different\",\"16\":\"different\",\"17\":\"different\"},{\"1\":\"11\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"1\",\"7\":\"0\",\"8\":\"1\",\"9\":\"1\",\"10\":\"yes\",\"11\":\"yes\",\"12\":\"yes\",\"13\":\"yes\",\"14\":\"same\",\"15\":\"same\",\"16\":\"same\",\"17\":\"same\"},{\"1\":\"12\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"1\",\"7\":\"1\",\"8\":\"0\",\"9\":\"0\",\"10\":\"no\",\"11\":\"no\",\"12\":\"no\",\"13\":\"no\",\"14\":\"different\",\"15\":\"different\",\"16\":\"different\",\"17\":\"different\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"1\",\"10\":\"yes\",\"11\":\"yes\",\"12\":\"yes\",\"13\":\"yes\",\"14\":\"different\",\"15\":\"different\",\"16\":\"different\",\"17\":\"different\"},{\"1\":\"7\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"yes\",\"11\":\"yes\",\"12\":\"yes\",\"13\":\"yes\",\"14\":\"same\",\"15\":\"same\",\"16\":\"same\",\"17\":\"same\"},{\"1\":\"10\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"1\",\"7\":\"0\",\"8\":\"1\",\"9\":\"0\",\"10\":\"no\",\"11\":\"no\",\"12\":\"no\",\"13\":\"no\",\"14\":\"same\",\"15\":\"same\",\"16\":\"same\",\"17\":\"same\"},{\"1\":\"5\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"1\",\"8\":\"0\",\"9\":\"1\",\"10\":\"yes\",\"11\":\"yes\",\"12\":\"yes\",\"13\":\"yes\",\"14\":\"different\",\"15\":\"different\",\"16\":\"different\",\"17\":\"different\"},{\"1\":\"4\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"1\",\"8\":\"0\",\"9\":\"0\",\"10\":\"no\",\"11\":\"no\",\"12\":\"no\",\"13\":\"no\",\"14\":\"different\",\"15\":\"different\",\"16\":\"different\",\"17\":\"different\"},{\"1\":\"1131675649\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"1\",\"10\":\"yes\",\"11\":\"yes\",\"12\":\"yes\",\"13\":\"yes\",\"14\":\"different\",\"15\":\"different\",\"16\":\"different\",\"17\":\"different\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n### g_flags\n\nIt looks that this variable have just the same value for every observation:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(reflectance_500$gflags)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0\n```\n:::\n:::\n\n\nGiven that I don't have any values there other than 0, I'm not going to apply \nthe function to this variable.\n\n# Conclusions on the bit conversion\n\n - All steps and references are documented.\n - I created a function to do the bit mask conversion\n - Function will be exported to a new file and documented as a formal function \n   in R to be used in the next steps for the data analysis.\n - After using the function, steps to include the correspondent categories \n   according to the official MODIS documentation are needed.\n - The new data frames with the bit strings and the categories per each unique \n   value will be used to filter the all the original observations from the \n   datasets.\n\n# Quality filtering\n\nNow that I have validated the function and I have per each of the variables with bit mask the categories obtained from the MODIS documentation, I can start with filtering out those pixels with low quality.\n\n### Select bitmasks categories that indicates high quality\n\n-   First I will start with `state_1km`\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# quality values from state_1km\n# bit 6-7 and bit 13 can be anything as regarded by richard\nstate_1km_highest_quality <- state_1km__description |>\n  filter(cloud_state_qa == \"clear\") |> \n  filter(cloud_shadow_qa == \"no\") |>\n  filter(land_water_qa == \"land\") |> \n  filter(cirrus_detected_qa == \"none\") |> \n  filter(bit_10 == \"0\") |> \n  filter(fire_flag_qa == \"no fire\") |> \n  filter(snow_ice_flag_qa == \"no\") |> \n  filter(bit_14 == \"0\") |> \n  filter(bit_15 == \"0\") |> \n  select(qc_ints) |> \n  pull()\n\nstate_1km_highest_quality\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 8392  200  136    8   72 8264 8328\n```\n:::\n:::\n\n\n-   Filtering with `qc_500m`\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# quality values from qc_500\n# All should be 0 for all of the bits, except for \nqc_500_highest_quality <- qc_500_description |>\n  filter(modland_qa == \"ideal quality - all bands\") |>\n  filter(band1_qa == \"highest_quality\") |>\n  filter(band2_qa == \"highest_quality\") |>\n  filter(band3_qa == \"highest_quality\") |>\n  filter(band4_qa == \"highest_quality\") |>\n  filter(band5_qa == \"highest_quality\") |>\n  filter(band6_qa == \"highest_quality\") |>\n  filter(band7_qa == \"highest_quality\") |>\n  filter(atmospheric_correction == \"yes\") |>\n  # filter(adjacency_correction == \"yes\") |> \n  select(qc_ints) |> \n  pull()\n\nqc_500_highest_quality\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1073741824\n```\n:::\n:::\n\n\n-   Filtering with q_scan\n\nFrom the meeting with Richard Fernandes, we agreed to leave this one out.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# quality values from q_scan\n# This one is fine if I don't use it and let it be.\n```\n:::\n\n\n-   Filtering with gflags\n\nFor the `reflectance_500` dataset, we have the same value in all the observations\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# quality values for gflags\n# gflags_highest_quality <- reflectance_500 |>\n#   filter(gflags == 0)\n```\n:::\n\n\n### Filter from complete data the selected bitmasks\n\nSo far, I have the bitmasks that indicates the highest quality, so I can filter out the rest from the `reflectance_500` dataset\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstate_1km_filter <- reflectance_500 |> \n  filter(state_1km %in% state_1km_highest_quality) |> \n  nrow()\n\nstate_1km_filter\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4586\n```\n:::\n:::\n\n\nThose number of observations represents just the filtering based on the `state_1km` variable. Now, I will continue with the `qc_500` variable:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstate_1km_filter_qc_500 <- reflectance_500 |> \n  filter(state_1km %in% state_1km_highest_quality) |> \n  filter(qc_500m %in% qc_500_highest_quality) |> \n  nrow()\n\nstate_1km_filter_qc_500\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4319\n```\n:::\n:::\n\n\n## Some plots with clean reflectance_500 data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreflectance_500 |> \n  filter(state_1km %in% state_1km_highest_quality) |> \n  select(date) |> \n  # pull() |> \n  mutate(year_month = zoo::as.yearmon(date)) |> \n  ggplot(aes(x = date)) + \n  geom_histogram() +\n  scale_x_date(date_labels = \"%b%Y\", breaks = \"months\") +\n  theme(axis.text.x = element_text(angle = 90, h = 1)) +\n  labs(x = \"Date\",\n       y = \"Number of pixels\",\n       title = \"Borden  MODIS pixels per month after quality filtering\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n\n# Conclusion\n\n-   Function `obtain_bit_qc_df()` can be used to do the bit string conversion\n-   All steps are summarized in the function. Code here is just the historical reference. Functional and documented code for the function is in the `R/create_bit_string.R` file.\n-   The code to create the human readable categories from the bit strings so that bad/high quality filtering of the pixels can be done in the analysis is in the `scripts/create_bitstrings_tables.R`.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}